(this["webpackJsonpath-capital"]=this["webpackJsonpath-capital"]||[]).push([[7],{605:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(205),a=r(0);function i(){return Object(a.useContext)(n.a)}},612:function(e,t,r){"use strict";function n(e){return e&&!/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e)?"Invalid email address":void 0}r.d(t,"a",(function(){return n}))},720:function(e,t,r){"use strict";r.r(t);var n=r(626),a=r.n(n),i=r(627),o=r(76),l=r(0),c=r(17),s=r(25),u=r(638),d=r.n(u),m=r(319),f=r(27),b=r(553),j=r(10),p=r(605),h=r(16),v=r(607),O=r(730),x=r(603),g=r(612),w=r(693),C=r(665),y=r(733),S=r(695),k=r(725),N=r(111),T=r(3),W=Object(b.a)((function(e){return{root:Object(h.a)(Object(h.a)({},e.flexColumnCenter),{},{justifyContent:"flex-start",flexGrow:1,height:"100%",width:"100%",margin:".2rem",fontSize:"1.4rem"}),submit:Object(h.a)(Object(h.a)({},e.flexColumnCenter),{},{justifyContent:"center",flexGrow:1,textAlign:"center",padding:"1.25rem",minWidth:"192px",marginTop:"1.5rem"})}}));var L=function(e){var t=e.onSubmit,r=W(),n=Object(v.b)({mode:"onChange",nativeValidation:!1}),a=n.register,i=n.handleSubmit,o=n.formState,l=o.isSubmitting,c=o.isValid,s=o.errors,u=n.control;return Object(T.jsxs)("form",{className:r.root,onSubmit:i(t),children:[Object(T.jsx)(O.a,{placeholder:"\u041b\u043e\u0433\u0438\u043d",autoComplete:"username",margin:"normal",fullWidth:!0,inputProps:Object(h.a)({},a("username"))}),Object(T.jsx)(O.a,{type:"email",placeholder:"email",autoComplete:"email",margin:"normal",fullWidth:!0,inputProps:Object(h.a)({},a("email",{required:!0,validate:g.a})),error:!!s.email,helperText:s.email&&"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 E-mail"}),Object(T.jsx)(O.a,{type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",autoComplete:"current-password",margin:"normal",fullWidth:!0,inputProps:Object(h.a)({},a("password",{required:!0})),error:!!s.password,helperText:s.password&&"\u041d\u043e\u0431\u0445\u043e\u0434\u0438\u043c \u043f\u0430\u0440\u043e\u043b\u044c"}),Object(T.jsxs)(w.a,{component:"fieldset",fullWidth:!0,children:[Object(T.jsx)(S.a,{component:"legend",children:"\u0422\u0438\u043f \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438"}),Object(T.jsx)(v.a,{rules:{required:!0},control:u,defaultValue:N.b,name:"role",render:function(e){var t=e.name;e.onBlur,e.onChange,e.value;return Object(T.jsxs)(y.a,{name:t,defaultValue:N.b,children:[Object(T.jsx)(C.a,{value:N.b,control:Object(T.jsx)(k.a,{color:"primary"}),label:"\u0418\u043d\u0432\u0435\u0441\u0442\u043e\u0440"}),Object(T.jsx)(C.a,{value:N.c,control:Object(T.jsx)(k.a,{color:"primary"}),label:"\u041c\u0430\u0440\u043a\u0435\u0442\u043e\u043b\u043e\u0433"})]})}})]}),Object(T.jsx)("div",{className:r.submit,children:Object(T.jsx)(x.a,{color:"primary",type:"submit",variant:"contained",disabled:l||!c,children:l?"\u0417\u0430\u0433\u0440\u0443\u0445\u043a\u0430":"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})})]})},A=Object(b.a)((function(e){return{root:Object(h.a)(Object(h.a)({},e.flexColumnCenter),{},{justifyContent:"flex-start",height:"100%",width:"100%",fontWeight:400,paddingTop:"1.5rem"}),panel:Object(h.a)(Object(h.a)({},e.flexColumnCenter),{},{justifyContent:"center",flexGrow:1,padding:"1.25rem",minWidth:"250px",minHeight:"270px"}),orLabel:{marginTop:"1rem",marginBottom:".5rem"},login:Object(h.a)(Object(h.a)({},e.flexColumnCenter),{},{justifyContent:"center",marginTop:"1.5rem"}),loginLabel:{fontSize:"1rem",fontWeight:"bold"},loginLink:{fontSize:"1.2rem"},providers:{marginTop:"1rem"}}}));var V=function(){var e=A(),t=Object(p.a)().showError,r=Object(f.useFirebase)(),n=Object(f.useFirestore)(),u=new URLSearchParams(Object(c.h)().search),b=r.firestore(),h=Object(l.useState)(""),v=Object(o.a)(h,2),O=v[0],x=v[1];Object(l.useEffect)((function(){if(u.get("referral")){var e=u.get("referral"),t=b.collection("users").doc(e),r=b.doc(t.path);x(r)}}),[]);var g=function(){var e=Object(i.a)(a.a.mark((function e(t){var r,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={createdAt:t.createdAt,email:t.email},null===(null===t||void 0===t?void 0:t.referrer)){e.next=5;break}return e.next=4,null===t||void 0===t||null===(o=t.referrer)||void 0===o?void 0:o.update({level1:n.FieldValue.arrayUnion(r)});case 4:n.collection("users").doc(u.get("referral")).get().then(function(){var e=Object(i.a)(a.a.mark((function e(t){var o,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(null===(o=t.data())||void 0===o?void 0:o.referrer)){e.next=5;break}return e.next=4,null===o||void 0===o||null===(l=o.referrer)||void 0===l?void 0:l.update({level2:n.FieldValue.arrayUnion(r)});case 4:o.referrer.get().then(function(){var e=Object(i.a)(a.a.mark((function e(t){var i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(null===(i=t.data())||void 0===i?void 0:i.referrer)){e.next=4;break}return e.next=4,null===i||void 0===i||null===(o=i.referrer)||void 0===o?void 0:o.update({level3:n.FieldValue.arrayUnion(r)});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(T.jsxs)("div",{className:e.root,children:[Object(T.jsx)(m.a,{className:e.panel,children:Object(T.jsx)(L,{onSubmit:function(e){return r.createUser(e,{email:e.email,displayName:e.username,role:e.role,wallet:0,level1:[],level2:[],level3:[],referrer:O||null,createdAt:n.Timestamp.now()}).then(g).catch((function(e){return t(e.message)}))},onSubmitFail:function(e,r,n){t(e?"Form Invalid":n.message||"Error")}})}),Object(T.jsx)("div",{className:e.orLabel,children:"\u0438\u043b\u0438"}),Object(T.jsx)("div",{className:e.providers,children:Object(T.jsx)(d.a,{onClick:function(){return r.login({provider:"google",type:"popup"}).then(function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.additionalUserInfo.isNewUser){e.next=4;break}return e.next=3,n.collection("users").doc(t.user.uid).update({role:N.b,wallet:0,level1:[],level2:[],level3:[],referrer:O||null,createdAt:n.Timestamp.now()});case 3:n.collection("users").doc(t.user.uid).get().then(function(){var e=Object(i.a)(a.a.mark((function e(t){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.data(),g(r);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return t(e.message)}))},"data-test":"google-auth-button"})}),Object(T.jsxs)("div",{className:e.login,children:[Object(T.jsx)("span",{className:e.loginLabel,children:"\u0423 \u0432\u0430\u0441 \u0443\u0436\u0435 \u0435\u0441\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442?"}),Object(T.jsx)(s.b,{className:e.loginLink,to:j.d,children:"A\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]})]})},F=r(20).b;t.default=F(V)},726:function(e,t,r){"use strict";r.r(t);r(0);var n=r(17),a=r(25),i=r(319),o=r(27),l=r(553),c=r(16),s=r(149),u=r(603),d=r(10),m=r(33),f=r(605),b=r(3),j=Object(l.a)((function(e){return{root:Object(c.a)(Object(c.a)({},e.flexColumnCenter),{},{justifyContent:"flex-start",height:"100%",width:"100%",fontWeight:400,paddingTop:"1.5rem"}),panel:Object(c.a)(Object(c.a)({},e.flexColumnCenter),{},{justifyContent:"center",flexGrow:1,padding:"2rem",minWidth:"250px"}),orLabel:{marginTop:"1rem",marginBottom:".5rem"},login:Object(c.a)(Object(c.a)({},e.flexColumnCenter),{},{justifyContent:"center",marginTop:"1.5rem"}),loginLabel:{fontSize:"1rem",fontWeight:"bold"},loginLink:{fontSize:"1.2rem"},providers:{marginTop:"1rem"}}}));var p=function(){var e=j(),t=Object(o.useFirebase)(),r=Object(m.useSelector)((function(e){return e.firebase.auth.emailVerified})),l=Object(m.useSelector)((function(e){return e.firebase.profile})),c=Object(f.a)().showSuccess;return"admin"===l.role?Object(b.jsx)(n.a,{to:d.i}):r?Object(b.jsx)(n.a,{to:d.c}):Object(b.jsx)("div",{className:e.root,children:Object(b.jsxs)(i.a,{className:e.panel,children:[Object(b.jsx)(s.a,{variant:"h6",component:"p",children:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0432\u0430\u0448 E-mail."}),Object(b.jsx)(u.a,{component:a.b,onClick:function(){t.auth().currentUser.sendEmailVerification(),c("\u041f\u0438\u0441\u044c\u043c\u043e \u0432\u0435\u0440\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u0431\u044b\u043b\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e \u043d\u0430 \u0432\u0430\u0448 E-mail")},"data-test":"sign-in",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043f\u0438\u0441\u044c\u043c\u043e \u0432\u0435\u0440\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438"})]})})},h=r(20).a;t.default=h(p)}}]);
//# sourceMappingURL=Signup.ba25a494.chunk.js.map